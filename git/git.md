Полезные приемы при работе с Git
================================================================================
Сборник рецептов для работы с системой контроля версий Git, а также удаленными
репозиториями. Большинство рецептов найдены на просторах сети, но проверены на
практике. Применение некоторых может быть связано с рисками, так что если Вы
решили воспользовать одним из них, то вся ответственность лежит только на Вас.


Создание "чистого" репозитория
--------------------------------------------------------------------------------
Под "чистым" или "голым" репозиторием понимается репозиторий Git, не имеющий
рабочей директории, а содержащий только служебную информацию. Используется для
предоставления общего доступа к репозиторию.

Создание "чистого" репозитория на основе существующего

    $ git clone --bare repository repository.git

Теперь можно скопировать полученный repository.git на удаленный сервер и
настроить доступ к нему, например, по протоколу SSH.

Для того, чтобы добавить "чистый" репозиторий к оригинальному нужно перейти в
каталог оригинального репозитория и выполнить команду:

    $ cd repository
    $ git remote add origin ../repository.git
    $ git fetch


Изменение сообщения в последнем коммите
--------------------------------------------------------------------------------
Можно изменить сообщение последнего коммита

    $ git commit --amend

Или добавить в него что-то, что хотелось добавить но не удалось

    $ git add .
    $ git commit --amend -m 'Текст сообщения коммита'


Перенос последнего коммита в другую ветку
--------------------------------------------------------------------------------
В случае сохранения коммита в ошибочно выбранную ветку

Первый вариант, отменяем последний коммит, но сохраняем изменения в рабочей
директории

    $ git reset HEAD~ --soft
    $ git stash
    $ git checkout correct-branch-name
    $ git stash pop
    $ git add .
    $ git commit -m 'Текст сообщения коммита'

Второй вариант, используем cherry-pick

    $ git checkout correct-branch-name
    $ git cherry-pick master
    $ git checkout master
    $ git reset HEAD~ --hard




Отмена сделанного коммита, отправленного на удаленный репозиторий
--------------------------------------------------------------------------------
Отмена коммита отправленного на удаленный репозиторий может иметь очень
серьезные последствия, так что использовать этот рецет только в случае крайней
необходимости и отсутствия возможности использовать другой способ!

> В качестве примера используется сценарий удаления ошибочного коммита из ветки
> master, который является самым последним.

Первоначально нужно сохранить изменения, которые вошли в ошибочный коммит,
например, сохранить их в отдельной ветке или убрать в stash!

    $ git branch new-branch-name

Получаем все изменения из удаленного репозитория

    $ git checkout master
    $ git fetch --all
    $ git rebase origin/master

Далее делаем "жесткий" сброс указателя на HEAD на одни коммит назад и загружаем
в удаленный репозиторий с режимом "ускоренной перемотки" (force).

    $ git reset --hard HEAD~1
    $ git push origin master -f
